<!DOCTYPE html>
<!--
PTMVision WEB APPLICATION
AUTHOR: Caroline Jachmann, Simon Hackl
CONTACT: caroline.jachmann@uni-tuebingen.de, simon.hackl@uni-tuebingen.de
VERSION: 1.0

LICENSE
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<html>
  <head>
    <title>PTMVision</title>
    <link
      rel="icon"
      type="image/x-icon"
      href="{{ url_for('static', filename='resources/logo.png') }}"
    />
    <!--
      Provide meta information about the application.
      -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!--<meta
      name="description"
      content="..."
    /> TODO, GENERATE DESCRIPTION -->
    <meta name="author" content="Caroline Jachmann, Simon Hackl" />
    <!--
      Definition of stylesheets to use in the application.
      -->
    <link
      rel="stylesheet"
      href="https://cdn.korzh.com/metroui/v4/css/metro-all.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="{{url_for('static', filename='css/contextual.css')}}"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="{{url_for('static', filename='css/contextual.theme.css')}}"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://unpkg.com/tabulator-tables@5.5.0/dist/css/tabulator.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://unpkg.com/tabulator-tables@5.5.0/dist/css/tabulator_bootstrap4.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="{{url_for('static', filename='css/index.css')}}"
    />
    <!--
      Definition of java script files to use in the application.
      -->
    <script
      type="text/javascript"
      src="https://code.jquery.com/jquery-3.6.0.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.korzh.com/metroui/v4/js/metro.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://kit.fontawesome.com/df04f22e3d.js"
      crossorigin="anonymous"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/resize-sensor@0.0.6/ResizeSensor.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://3Dmol.org/build/3Dmol-min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/sweetalert2@11"
    ></script>
    <script
      type="text/javascript"
      src="https://unpkg.com/axios@1.1.2/dist/axios.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://unpkg.com/tabulator-tables@5.5.0/dist/js/tabulator.min.js"
    ></script>
    <script
      type="text/javascript"
      src="{{url_for('static', filename='js/pako.min.js')}}"
    ></script>
    <script
      type="text/javascript"
      src="{{url_for('static', filename='js/papaparse.min.js')}}"
    ></script>
    <script
      type="text/javascript"
      src="{{url_for('static', filename='js/index.js')}}"
    ></script>
    <script
      type="text/javascript"
      src="{{url_for('static', filename='js/contextual.js')}}"
    ></script>
    <script
      type="text/javascript"
      src="{{url_for('static', filename='js/dashboard.js')}}"
    ></script>
    <script>
      var API_PARAMETERS = JSON.parse(
        "{{api_parameters|safe}}".replaceAll("'", '"')
      );
    </script>
  </head>
  <body onLoad="init();">
    <!-- App menu -->
    <header
      id="menu"
      class="app-bar app-bar-expand"
      data-role="appbar"
      data-expand="true"
      data-role-appbar="true"
    >
      <div id="menu-grid" class="grid w-100">
        <div class="row">
          <div class="cell-5 text-center">
            <button
              onclick="redirectSource()"
              class="button-no-decoration menu-button float-left ml-8"
              data-role="hint"
              data-hint-text="Source Code<br>(GitHub)"
              data-hint-position="bottom"
            >
              <i class="fa-brands fa-github-alt"></i>
            </button>
            <button
              onclick="redirectHelp()"
              class="button-no-decoration menu-button float-left ml-2"
              data-role="hint"
              data-hint-text="Legal<br>Information"
              data-hint-position="bottom"
            >
              <i class="fa-duotone fa-book-section"></i>
            </button>
            <button
              class="button-no-decoration menu-button float-left ml-2"
              data-role="hint"
              data-hint-text="Download<br>Session (Binary)"
              data-hint-position="bottom"
              disabled
            >
              <i class="fa-duotone fa-cloud-arrow-down"></i>
            </button>
          </div>
          <div class="cell-2 text-center">
            <div class="logo no-hover">
              <img
                src="{{ url_for('static', filename='resources/logo.png') }}"
                alt="PTMVision Logo"
              />
            </div>
          </div>
          <div class="cell-5 text-center">
            <button
              class="button-no-decoration menu-button float-right mr-8"
              style="cursor: default"
            >
              <i
                id="process-indicator"
                class="fa-regular fa-circle"
                data-role="hint"
                data-hint-text="No Process Running"
                data-hint-position="left"
              ></i>
            </button>
          </div>
        </div>
      </div>
    </header>

    <div id="main">
      <div id="panel">
        <div id="panel-info" class="panel-container"></div>

        <div id="panel-inputs" class="panel-container">
          <h6 class="secondary">
            <i class="fa-duotone fa-circle-1"></i> Upload Search Engine Output
          </h6>
          <h7 class="secondary">Specify Pipeline:</h7>
          <select data-role="select" id="data-type-form">
            <optgroup label="Pipeline">
              <option value="ionbot">Ionbot</option>
              <option value="msfragger">MSFragger</option>
              <option value="sage">Sage</option>
              <option value="csv">Plain CSV</option>
            </optgroup>
          </select>
          <h7 class="secondary">Select Data:</h7>
          <input
            id="data-input-form"
            type="file"
            data-role="file"
            data-button-title='<i class="fa-duotone fa-folder-open"></i>'
          />
          <h7 class="secondary">Select Meta-Information (Optional):</h7>
          <input
            id="meta-input-form"
            type="file"
            data-role="file"
            data-button-title='<i class="fa-duotone fa-folder-open"></i>'
          />
          <button class="proceed-button mt-2" onclick="uploadData()">
            Submit
          </button>
          <hr class="mt-6" />
          <h6 class="secondary">
            <i class="fa-duotone fa-circle-arrow-up-right"></i> Restore Session
          </h6>
          <h7 class="secondary">Select Data:</h7>
          <input
            id="session-input-form"
            type="file"
            data-role="file"
            data-button-title='<i class="fa-duotone fa-folder-open"></i>'
            disabled
          />
          <button class="proceed-button mt-2" disabled>Restore</button>
        </div>

        <div id="panel-overview-table" class="panel-container">
          <div class="grid">
            <div class="row">
              <div class="cell-11">
                <h6 class="secondary">
                  <i class="fa-duotone fa-circle-2"></i> Select Protein to
                  Explore
                </h6>
              </div>
              <div class="cell-1">
                <button
                  id="dashboard-display-button"
                  class="proceed-button float-right"
                  onclick="getDashboard( )"
                  disabled
                >
                  Display
                </button>
              </div>
            </div>
            <div class="row">
              <div class="cell-3">
                <h7 class="secondary float-left"
                  >Filter for Modifications:&nbsp;</h7
                >
              </div>
              <div class="cell-9">
                <select
                  id="panel-overview-table-filter-modification"
                  class="input-small"
                  data-role="select"
                  data-on-change="_set_table_filters"
                  multiple
                ></select>
              </div>
            </div>
            <div class="row mt-2">
              <div class="cell-3">
                <h7 class="secondary float-left">Filter for ID/Name:&nbsp;</h7>
              </div>
              <div class="cell-9">
                <select
                  id="panel-overview-table-filter-id"
                  class="input-small"
                  data-role="select"
                  data-on-change="_set_table_filters"
                  multiple
                ></select>
              </div>
            </div>
          </div>
          <div id="panel-overview-table-tabulator"></div>
        </div>

        <div id="panel-overview-graph" class="panel-container">
          <span>
            <i
              class="fa-duotone fa-circle-info"
              data-role="hint"
              data-hint-position="left"
              data-hint-hide="20000"
              data-hint-text="
                <p class='text-just'>
                <text-just>
                <b>Modifications Overview Graph</b>
                <br>
                &#8226; Displays top 10% of modifications wrt. absolute occurrence in the dataset.
                <br>
                &#8226; Hovering emphazises adjacency.
                <br>
                &#8226; Nodes represent modifications:
                <br>
                &nbsp;&#8901; Size encodes absolute occurrence across all proteins.
                <br>
                &nbsp;&#8901; Color encodes frequency (at least one occurrence) across all proteins.
                <br>
                &#8226; Edges link modifications that co-occur at positions of one protein:
                <br>
                &nbsp;&#8901; Width encodes absolute co-occurrence.
                </p>
                "
            ></i>
            Modifications Overview Graph
          </span>
          <div id="panel-overview-graph-chart"></div>
        </div>

        <div id="panel-dashboard" class="panel-container">
          <div id="dashboard-overview">Overview</div>
          <div id="dashboard-structure">Structure</div>
          <div id="dashboard-map">Map</div>
          <div id="dashboard-detail">Detail</div>
        </div>

        <div id="panel-legal">
          <div class="grid">
            <div class="row">
              <div class="cell-2">
                <p class="text-upper text-leader2 text-center">citation</p>
                <p class="text-light text-just">
                  If you use any component of PTMVision in your work, please
                  cite
                  <br />
                  <span class="citation">
                    Jachmann et al., (2023, April 05), PTMVision,
                    https://github.com/Integrative-Transcriptomics/PTMVision</span
                  >
                </p>
              </div>
              <div class="cell-6 offset-1">
                <p class="text-upper text-leader2 text-center">compatibility</p>
                <br />
                <table class="table subcompact table-border cell-border">
                  <thead>
                    <tr>
                      <th>OS</th>
                      <th>Version</th>
                      <th>Chrome</th>
                      <th>Firefox</th>
                      <th>Edge</th>
                      <th>Safari</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>Linux</th>
                      <th>Ubuntu 20.04.4</th>
                      <th>not tested</th>
                      <th>102.08</th>
                      <th>N/A</th>
                      <th>N/A</th>
                    </tr>
                    <tr>
                      <th>MacOS</th>
                      <th>Ventura 13.0.1</th>
                      <th>108.0.5359.124</th>
                      <th>108.1</th>
                      <th>N/A</th>
                      <th>16.1</th>
                    </tr>
                    <tr>
                      <th>Windows</th>
                      <th>11</th>
                      <th>108.0.5359.125</th>
                      <th>108.0</th>
                      <th>108.0.1462.54</th>
                      <th>N/A</th>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="cell-2 offset-1">
                <p class="text-upper text-leader2 text-center">legal</p>
                <p class="text-light text-just">
                  This website is free and open to all users and there is no
                  login requirement. All submitted data is kept confidential. We
                  use a strictly necessary (http-only non-tracking) session
                  cookie so that you can access your data! By using PTMVision
                  you consent to using this cookie.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
